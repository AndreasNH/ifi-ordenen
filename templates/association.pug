extends layout

block prepend title
  | #{page.title} -

block vars
  - mainclass = 'association';

block content
  != page.html
  - var persons = env.helpers.getPersonsForTag(contents, page.metadata.tag)
  if page.metadata.current || page.metadata.previous || page.metadata.url
    hr
    h3 Annen informasjon
    ul
      if page.metadata.current
        - currentAssociation = env.helpers.getAssociation(contents, page.metadata.current)
        li
          span NÃ¥ kjent som&nbsp;
          a(href=currentAssociation.url)= currentAssociation.title
      if page.metadata.previous
        - prevAssociation = env.helpers.getAssociation(contents, page.metadata.previous)
        li
          span Tidligere kjent som&nbsp;
          a(href=prevAssociation.url)= prevAssociation.title
      if page.metadata.url
        li
          span Nettside:&nbsp;
          a(href=page.metadata.url)= page.metadata.url.replace('http://', '').replace('https://', '').replace(/\/$/, '')
  if persons.length > 0
    hr
    h3 OrdensbÃ¦rere
    ul
      each person in persons
        - var username = person.filepath.relative.split('/')[1]
        - var individual = person.metadata
        li
          a(href=locals.url + person.url)= person.title
          span  (#{env.helpers.getTitleName(contents, individual.current)})
  - var years = env.helpers.getYearsForTag(contents, page.metadata.tag)
  - var references = env.helpers.getReferencesForHistory(years)
  if years.length > 0
    hr
    h3 Historie
    ul.history
      each year in years
        li.year
          h4= year.year
          ul
            each event in year.events
              li.event
                include history-event.pug
            if year.minor.length > 0
              li.event Mindre hendelser
                ul
                  each event in year.minor
                    li.event
                      include history-event.pug
  if Object.keys(references).length > 0
    h3 Referanser
    ol.references
      each reference in references
        li(id=reference.index).reference
          != reference.html